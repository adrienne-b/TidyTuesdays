library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
dog_moves <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_moves.csv')
dog_moves <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_moves.csv')
dog_travel <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_travel.csv')
dog_moves <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_moves.csv')
dog_travel <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_travel.csv')
dog_descriptions <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_descriptions.csv')
View(dog_descriptions)
theme_set(theme_light())
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
theme_set(theme_light())
# Get the Data
dog_moves <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_moves.csv')
dog_travel <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_travel.csv')
dog_descriptions <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_descriptions.csv')
dog_descriptions %>%
ggplot(x = sex)
dog_descriptions %>%
ggplot(x = sex) +
geom_bar()
dog_descriptions %>%
ggplot(x = sex) +
geom_bar(stat = "bin")
dog_descriptions %>%
ggplot(x = factor(sex)) +
geom_bar()
ggplot(aes(x = sex) +
dog_descriptions %>%
ggplot(aes(x = sex)) +
geom_bar()
dog_descriptions %>%
ggplot(aes(x = sex)) +
geom_bar()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# Get the Data
dog_moves <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_moves.csv')
dog_travel <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_travel.csv')
dog_descriptions <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_descriptions.csv')
dog_descriptions %>%
ggplot(aes(x = sex)) +
geom_bar()
dog_descriptions %>%
select(sex) %>%
chisq.test()
dog_descriptions %>%
select(sex) %>%
chisq.test(.)
dog_descriptions %>%
select(sex) %>%
count(sex)
dog_descriptions %>%
select(sex) %>%
count(sex) %>%
chisq.test()
dog_descriptions %>%
select(sex) %>%
count(sex) %>%
sex <-
dog_descriptions %>%
select(sex) %>%
count(sex)
sex <- dog_descriptions %>%
select(sex) %>%
count(sex)
View(sex)
sex <- dog_descriptions %>%
select(sex) %>%
count(sex) %>%
select(-unknown)
sex <- dog_descriptions %>%
select(sex) %>%
count(sex) %>%
select(-Unknown)
sex <- dog_descriptions %>%
select(sex) %>%
count(sex) %>%
filter(-Unknown)
filter(!sex == "Unknown"")
filter(!sex == "Unknown)
sex <- dog_descriptions %>%
select(sex) %>%
count(sex) %>%
filter(!sex == "Unknown")
sex <- dog_descriptions %>%
select(sex) %>%
count(sex) %>%
filter(!sex == "Unknown") %>%
chisq.test()
sex <- dog_descriptions %>%
select(sex) %>%
count(sex) %>%
filter(!sex == "Unknown") %>%
mutate(sex = factor(sex)) %>%
chisq.test()
sex <- dog_descriptions %>%
select(sex) %>%
count(sex) %>%
filter(!sex == "Unknown") %>%
mutate(sex = factor(sex))
chisq.test(sex)
View(sex)
sex <- dog_descriptions %>%
select(sex) %>%
count(sex) %>%
filter(!sex == "Unknown")
sex <- dog_descriptions %>%
select(sex) %>%
count(sex) %>%
filter(!sex == "Unknown") %>%
pivot_wider(names_from = sex, values_from = n)
View(sex)
chisq.test(sex)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# Get the Data
dog_moves <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_moves.csv')
dog_travel <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_travel.csv')
dog_descriptions <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_descriptions.csv')
dog_descriptions %>%
ggplot(aes(x = sex)) +
geom_bar()
dog_descriptions %>%
ggplot(aes(sex)) +
geom_boxplot()
dog_descriptions %>%
ggplot(aes(sex, count)) +
geom_boxplot()
dog_descriptions %>%
ggplot(aes(x = sex)) +
geom_boxplot()
dog_descriptions %>%
ggplot(aes(sex, n)) +
geom_boxplot()
dog_descriptions %>%
ggplot(aes(sex)) +
geom_boxplot()
dog_descriptions %>%
ggplot(aes(x = sex)) +
geom_boxplot()
dog_descriptions %>%
ggplot(aes(x = sex)) +
geom_boxplot()
dog_descriptions %>%
ggplot(aes(x = sex)) +
geom_boxplot()
dog_descriptions %>%
ggplot(aes(sex)) +
geom_bar()
dog_descriptions %>%
filter(sex == "unknown") %>%
ggplot(aes(sex)) +
geom_bar()
dog_descriptions %>%
filter(!sex == "unknown") %>%
ggplot(aes(sex)) +
geom_bar()
dog_descriptions %>%
filter(!sex == "Unknown") %>%
ggplot(aes(sex)) +
geom_bar()
dog_descriptions %>%
filter(!sex == "Unknown") %>%
ggplot(aes(sex)) +
geom_bar() +
geom_error(ymin = count + sd, ymax = count + sd)
dog_descriptions %>%
filter(!sex == "Unknown") %>%
ggplot(aes(sex)) +
geom_bar() +
geom_errorbar(ymin = count + sd, ymax = count + sd)
dog_descriptions %>%
filter(!sex == "Unknown") %>%
group_by(sex) %>%
summarise(count = n)
dog_descriptions %>%
filter(!sex == "Unknown") %>%
group_by(sex) %>%
count(sex)
dogs_sex <- dog_descriptions %>%
filter(!sex == "Unknown") %>%
group_by(sex) %>%
count(sex)
View(dogs_sex)
dogs_sex %>%
sd(count)
View(dogs_sex)
dogs_sex %>%
sd(n)
sd(dogs_sex(n))
sd(dogs_sex$n)
27883/30294
dogs_sex[1]/sum(dogs_sex[1],dogs_sex[2])
27883+30294
27883/58177
30294/58177
binom.test(27883,58177,0.5)
binom <- binom.test(27883,58177,0.5)
binom <- binom.test(27883,58177,0.5)
binom_f <- binom.test(27883,58177,0.5)
View(binom_f)
View(binom_f)
binom_f <- binom.test(dogs_sex$n[1],(dogs_sex$n[1] + dogs_sex$n[2]),0.5)
binom_m <- binom.test(dogs_sex$n[2],(dogs_sex$n[1] + dogs_sex$n[2]),0.5)
dogs_sex %>%
mutate(pvalue[1] = binom_f[3])
dogs_sex %>%
mutate(pvalue = binom_f[3])
View(binom_f)
dogs_sex %>%
mutate(pvalue = binom_f[3,2])
binom_f[3]
binom_f[3][1]
dogs_sex %>%
mutate(pvalue = binom_f[3][1])
dogs_sex %>%
mutate(pvalue = binom_f[3,1])
dogs_sex %>%
mutate(pvalue = binom_f[3][2])
dogs_sex %>%
mutate(pvalue[1] = binom_f[3][2])
dogs_sex %>%
mutate(pvalue(1) = binom_f[3][2])
dogs_sex %>%
mutate(pvalue(1) = binom_f[3][1])
dogs_sex %>%
mutate(pvalue = binom_f[[3]])
dogs_sex %>%
mutate(pvalue[[1]] = binom_f[[3]])
pvalue <- c(binom_f[[3]], binom_m[[3]])
dogs_sex %>%
mutate(pvalue = pvalue)
dogs_sex %>%
mutate(p = pvalue)
dogs_sex %>%
ungroup() %>%
mutate(p = pvalue)
pvalue <- c(binom_f[[3]], binom_m[[3]])
pvalue
dogs_sex <- dog_descriptions %>%
filter(!sex == "Unknown") %>%
group_by(sex) %>%
count(sex) %>%
ungroup()
dogs_sex %>%
mutate(p = pvalue) %>%
dogs_sex %>%
mutate(p = pvalue)
dogs_sex %>%
mutate(p = pvalue)
pvalue <- c(binom_f[[4]][[1]], binom_m[[4]][[1]])
pvalue <- c(binom_f[[3]], binom_m[[3]])
conf_low <- c(binom_f[[4]][[1]], binom_m[[4]][[1]])
conf_low
conf_high <- c(binom_f[[4]][[2]], binom_m[[4]][[2]])
dogs_sex %>%
mutate(p         = pvalue,
conf_low  = conf_low,
conf_high = conf_high)
ggplot(aes(sex)) +
geom_bar() +
geom_errorbar(ymin = n + conf_low, ymax = n + conf_high)
dogs_sex %>%
ggplot(aes(sex)) +
geom_bar() +
geom_errorbar(ymin = n + conf_low, ymax = n + conf_high)
confidence_low  <- c(binom_f[[4]][[1]], binom_m[[4]][[1]])
View(dogs_sex)
true_low <- confidence_low * dogs_sex$n
true_high <- confidence_high * dogs_sex$n
confidence_high <- c(binom_f[[4]][[2]], binom_m[[4]][[2]])
true_high <- confidence_high * dogs_sex$n
dogs_sex %>%
mutate(p         = pvalue,
conf_low  = conf_low,
conf_high = conf_high,
true_low  = true_low,
true_high = true_high)
sum(dogs_sex$n)
percent <- c(dogs_sex$n[1]/sum(dogs_sex$n), dogs_sex$n[2]/sum(dogs_sex$n))
percent
dogs_sex %>%
mutate(p         = pvalue,
percent   = percent
conf_low  = conf_low,
dogs_sex %>%
mutate(p         = pvalue,
percent   = percent,
conf_low  = conf_low,
conf_high = conf_high,
true_low  = true_low,
true_high = true_high)
true_low <- confidence_low * sum(dogs_sex$n)
true_high <- confidence_high * sum(dogs_sex$n)
dogs_sex %>%
mutate(percent   = percent,
p         = pvalue,
conf_low  = conf_low,
conf_high = conf_high,
true_low  = true_low,
true_high = true_high)
dogs_sex %>%
ggplot(aes(sex)) +
geom_bar() +
geom_errorbar(ymin = n + true_low, ymax = n + true_high)
dogs_sex %>%
ggplot(aes(sex)) +
geom_bar() +
geom_errorbar(aes(ymin = n - true_low, ymax = n + true_high))
dogs_sex %>%
ggplot(aes(sex)) +
geom_bar()
dogs_sex %>%
ggplot(aes(sex, n)) +
geom_bar()
dogs_sex %>%
ggplot(aes(sex)) +
geom_bar()
dogs_sex %>%
ggplot(aes(x = sex, y = n)) +
geom_bar()
dogs_sex %>%
ggplot(aes(sex, n)) +
geom_bar(stat = "identity")
dogs_sex %>%
ggplot(aes(sex, n)) +
geom_bar(stat = "identity") +
geom_errorbar(aes(ymin = n - true_low, ymax = n + true_high))
dogs_sex %>%
ggplot(aes(sex, n)) +
geom_bar(stat = "identity") +
geom_errorbar(aes(ymin = true_low, ymax = true_high))
dogs_sex %>%
ggplot(aes(sex, n)) +
geom_bar(stat = "identity", fill = "lightblue") +
geom_errorbar(aes(ymin = true_low, ymax = true_high))
dogs_sex %>%
ggplot(aes(sex, n)) +
geom_bar(stat = "identity", fill = "lightblue") +
geom_errorbar(aes(ymin = true_low, ymax = true_high), width = 0.5, color = "orange")
dogs_sex %>%
ggplot(aes(sex, n)) +
geom_bar(stat = "identity", fill = "lightblue") +
geom_pointrange(aes(ymin = true_low, ymax = true_high), width = 0.5, color = "orange")
dogs_sex %>%
ggplot(aes(sex, n)) +
geom_bar(stat = "identity", fill = "lightblue", width = 0.5) +
geom_pointrange(aes(ymin = true_low, ymax = true_high), width = 0.5, color = "orange")
dogs_sex %>%
ggplot(aes(sex, n)) +
geom_bar(stat = "identity", fill = "lightblue", width = 0.5) +
geom_crossbar(aes(ymin = true_low, ymax = true_high), width = 0.5, color = "orange")
dogs_sex %>%
ggplot(aes(sex, n)) +
geom_bar(stat = "identity", fill = "lightblue", width = 0.5) +
geom_errorbar(aes(ymin = true_low, ymax = true_high), width = 0.5, color = "orange")
dogs_sex %>%
ggplot(aes(sex, n)) +
geom_bar(stat = "identity", fill = "lightblue", width = 0.5) +
geom_errorbar(aes(ymin = true_low, ymax = true_high), width = 0.25, color = "orange")
# Get the Data
dog_moves <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_moves.csv')
dog_travel <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_travel.csv')
dog_descriptions <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_descriptions.csv')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
dogs_sex <- dog_descriptions %>%
filter(!sex == "Unknown") %>%
group_by(sex) %>%
count(sex) %>%
ungroup()
percent <- c(dogs_sex$n[1]/sum(dogs_sex$n), dogs_sex$n[2]/sum(dogs_sex$n))
binom_f <- binom.test(dogs_sex$n[1],(dogs_sex$n[1] + dogs_sex$n[2]),0.5)
binom_m <- binom.test(dogs_sex$n[2],(dogs_sex$n[1] + dogs_sex$n[2]),0.5)
pvalue <- c(binom_f[[3]], binom_m[[3]])
confidence_low  <- c(binom_f[[4]][[1]], binom_m[[4]][[1]])
confidence_high <- c(binom_f[[4]][[2]], binom_m[[4]][[2]])
true_low <- confidence_low * sum(dogs_sex$n)
true_high <- confidence_high * sum(dogs_sex$n)
dogs_sex %>%
mutate(percent   = percent,
p         = pvalue,
conf_low  = conf_low,
conf_high = conf_high,
true_low  = true_low,
true_high = true_high)
dogs_sex <- dog_descriptions %>%
filter(!sex == "Unknown") %>%
group_by(sex) %>%
count(sex) %>%
ungroup()
percent <- c(dogs_sex$n[1]/sum(dogs_sex$n), dogs_sex$n[2]/sum(dogs_sex$n))
binom_f <- binom.test(dogs_sex$n[1],(dogs_sex$n[1] + dogs_sex$n[2]),0.5)
binom_m <- binom.test(dogs_sex$n[2],(dogs_sex$n[1] + dogs_sex$n[2]),0.5)
pvalue <- c(binom_f[[3]], binom_m[[3]])
confidence_low  <- c(binom_f[[4]][[1]], binom_m[[4]][[1]])
confidence_high <- c(binom_f[[4]][[2]], binom_m[[4]][[2]])
true_low <- confidence_low * sum(dogs_sex$n)
true_high <- confidence_high * sum(dogs_sex$n)
dogs_sex %>%
mutate(percent   = percent,
p         = pvalue,
conf_low  = conf_low,
conf_high = conf_high,
true_low  = true_low,
true_high = true_high)
conf_low  <- c(binom_f[[4]][[1]], binom_m[[4]][[1]])
conf_high <- c(binom_f[[4]][[2]], binom_m[[4]][[2]])
true_low <- confidence_low * sum(dogs_sex$n)
true_high <- confidence_high * sum(dogs_sex$n)
dogs_sex %>%
mutate(percent   = percent,
p         = pvalue,
conf_low  = conf_low,
conf_high = conf_high,
true_low  = true_low,
true_high = true_high)
dogs_sex %>%
ggplot(aes(sex, n)) +
geom_bar(stat = "identity", fill = "lightblue", width = 0.5) +
geom_errorbar(aes(ymin = true_low, ymax = true_high), width = 0.25, color = "orange")
